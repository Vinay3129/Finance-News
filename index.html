<script>
  const SECTIONS = {
    "news-india": "/api/india/news",
    "news-us": "/api/us/news",
    "news-asia": "/api/asia/news",
    "news-europe": "/api/europe/news",
    "news-crypto": "/api/crypto/news",
  };

  function displayNews(id, articles) {
    const container = document.getElementById(id);
    container.innerHTML = "";
    if (!articles || articles.length === 0) {
      container.innerHTML = "<p>No news available at this time.</p>";
      return;
    }
    articles.forEach(article => {
      const link = article.url || article.link;
      const title = article.title || "Untitled";
      const date = article.pubDate || article.publishedAt || new Date().toISOString();
      const card = document.createElement("div");
      card.className = "news-card";
      card.innerHTML = `
        <h3><a href="${link}" target="_blank">${title}</a></h3>
        <p>${new Date(date).toLocaleString()}</p>
      `;
      container.appendChild(card);
    });
  }

  Object.entries(SECTIONS).forEach(([id, endpoint]) => {
    const container = document.getElementById(id);
    container.innerHTML = "<p>Loading...</p>";
    fetch(`http://127.0.0.1:5000${endpoint}`)
      .then(res => res.json())
      .then(json => {
        if (json.articles) displayNews(id, json.articles);
        else container.innerHTML = "<p>Error loading news.</p>";
      })
      .catch(err => {
        console.error(err);
        container.innerHTML = `<p>Error: ${err.message}</p>`;
      });
  });
</script>
